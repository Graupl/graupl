"use strict";var b=Object.defineProperty;var I=(i,t,s)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var e=(i,t,s)=>I(i,typeof t!="symbol"?t+"":t,s);function T(i,t){try{if(typeof t!="object"){const s=typeof t;throw new TypeError(`Elements given to isValidInstance() must be inside of an object. "${s}" given.`)}for(const s in t)if(!(t[s]instanceof i)){const r=typeof t[s];throw new TypeError(`${s} must be an instance of ${i.name}. "${r}" given.`)}return{status:!0,error:null}}catch(s){return{status:!1,error:s}}}function n(i,t){try{if(typeof t!="object"){const s=typeof t;throw new TypeError(`Values given to isValidType() must be inside of an object. "${s}" given.`)}for(const s in t){const r=typeof t[s];if(r!==i)throw new TypeError(`${s} must be a ${i}. "${r}" given.`)}return{status:!0,error:null}}catch(s){return{status:!1,error:s}}}function A(i){try{if(typeof i!="object"){const t=typeof i;throw new TypeError(`Values given to isQuerySelector() must be inside of an object. "${t}" given.`)}for(const t in i)try{if(i[t]===null)throw new Error;document.querySelector(i[t])}catch{throw new TypeError(`${t} must be a valid query selector. "${i[t]}" given.`)}return{status:!0,error:null}}catch(t){return{status:!1,error:t}}}function d(i){try{if(typeof i!="object"||Array.isArray(i)){const t=typeof i;throw new TypeError(`Values given to isValidClassList() must be inside of an object. "${t}" given.`)}for(const t in i){const s=typeof i[t];if(s!=="string")if(Array.isArray(i[t]))i[t].forEach(r=>{if(typeof r!="string")throw new TypeError(`${t} must be a string or an array of strings. An array containing non-strings given.`)});else throw new TypeError(`${t} must be a string or an array of strings. "${s}" given.`);else{const r={};r[t]=i[t],A(r)}}return{status:!0,error:null}}catch(t){return{status:!1,error:t}}}function h(i,t){i===""||i.length===0||(typeof i=="string"?t.classList.add(i):t.classList.add(...i))}function c(i,t){i===""||i.length===0||(typeof i=="string"?t.classList.remove(i):t.classList.remove(...i))}class k{constructor({accordionItemElement:t,controllerElement:s=null,showClass:r="show",hideClass:o="hide",transitionClass:a="transitioning",transitionTimer:u=150,isHidden:m=!1,initialize:f=!1,optionalKeySupport:p=!1}){e(this,"_dom",{accordionItem:null,controller:null});e(this,"_hidden",!1);e(this,"_showClass","");e(this,"_hideClass","");e(this,"_transitionClass","");e(this,"_transitionTimer",150);e(this,"_optionalKeySupport",!1);e(this,"_showEvent",new CustomEvent("grauplAccordionItemShow",{bubbles:!0,detail:{accordionItem:this}}));e(this,"_hideEvent",new CustomEvent("grauplAccordionItemHide",{bubbles:!0,detail:{accordionItem:this}}));e(this,"_errors",[]);this._dom={accordionItem:null,controller:null},this._dom.accordionItem=t,this._dom.controller=s,this._showClass=r,this._hideClass=o,this._transitionClass=a,this._transitionTimer=u,this._hidden=m,this._optionalKeySupport=p,f&&this.initialize()}initialize(){try{if(!this._validate())throw new Error(`Graupl Accordion item: cannot initialize accordion item. The following errors have been found:
 - ${this.errors.join(`
 - `)}`)}catch(t){console.error(t)}}get dom(){return this._dom}get isHidden(){return this._hidden}get showClass(){return this._showClass}get hideClass(){return this._hideClass}get transitionClass(){return this._transitionClass}get transitionTimer(){return this._transitionTimer}get optionalKeySupport(){return this._optionalKeySupport}get errors(){return this._errors}set isHidden(t){n("boolean",{isHidden:t}),this._hidden!==t&&(this._hidden=t)}set showClass(t){d({showClass:t}),this._showClass!==t&&(this._showClass=t)}set hideClass(t){d({hideClass:t}),this._hideClass!==t&&(this._hideClass=t)}set transitionClass(t){d({transitionClass:t}),this._transitionClass!==t&&(this._transitionClass=t)}set transitionTimer(t){n("number",{transitionTimer:t}),this._transitionTimer!==t&&(this._transitionTimer=t)}set optionalKeySupport(t){n("boolean",{optionalKeySupport:t}),this._optionalKeySupport!==t&&(this._optionalKeySupport=t)}toggle(){this._hidden?this.show():this.hide()}_validate(){let t=!0;const s=n("boolean",{isHidden:this._hidden});s.status||(this._errors.push(s.error.message),t=!1);const r=n("number",{transitionTimer:this._transitionTimer});r.status||(this._errors.push(r.error.message),t=!1);const o=n("boolean",{optionalKeySupport:this._optionalKeySupport});o.status||(this._errors.push(o.error.message),t=!1);const a=d({showClass:this._showClass,hideClass:this._hideClass,transitionClass:this._transitionClass});return a.status||(this._errors.push(a.error.message),t=!1),t}show(t=!0){this._hidden&&(this.transitionClass!==""?(h(this.transitionClass,this.dom.accordionItem),requestAnimationFrame(()=>{this.hideClass!==""&&c(this.hideClass,this.dom.accordionItem),requestAnimationFrame(()=>{this.showClass!==""&&h(this.showClass,this.dom.accordionItem),requestAnimationFrame(()=>{c(this.transitionClass,this.dom.accordionItem)})})})):(this.showClass!==""&&h(this.showClass,this.dom.accordionItem),this.hideClass!==""&&c(this.hideClass,this.dom.accordionItem)),this._hidden=!1,this.dom.controller.setAttribute("aria-expanded","true"),t&&this.dom.accordionItem.dispatchEvent(this._showEvent))}hide(t=!0){this._hidden||(this.transitionClass!==""?(h(this.transitionClass,this.dom.accordionItem),requestAnimationFrame(()=>{this.showClass!==""&&c(this.showClass,this.dom.accordionItem),requestAnimationFrame(()=>{this.transitionTimer>0?setTimeout(()=>{this.hideClass!==""&&h(this.hideClass,this.dom.accordionItem),requestAnimationFrame(()=>{c(this.transitionClass,this.dom.accordionItem)})},this.transitionTimer):(this.hideClass!==""&&h(this.hideClass,this.dom.accordionItem),requestAnimationFrame(()=>{c(this.transitionClass,this.dom.accordionItem)}))})})):(this.hideClass!==""&&h(this.hideClass,this.dom.accordionItem),this.showClass!==""&&c(this.showClass,this.dom.accordionItem)),this.dom.controller.setAttribute("aria-expanded","false"),this._hidden=!0,t&&this.dom.accordionItem.dispatchEvent(this._hideEvent))}focus(){this.dom.controller.focus()}blur(){this.dom.controller.focus()}}function _(i){try{const t=i.key||i.keyCode,s={Enter:t==="Enter"||t===13,Space:t===" "||t==="Spacebar"||t===32,Escape:t==="Escape"||t==="Esc"||t===27,ArrowUp:t==="ArrowUp"||t==="Up"||t===38,ArrowRight:t==="ArrowRight"||t==="Right"||t===39,ArrowDown:t==="ArrowDown"||t==="Down"||t===40,ArrowLeft:t==="ArrowLeft"||t==="Left"||t===37,Home:t==="Home"||t===36,End:t==="End"||t===35,Tab:t==="Tab"||t===9};return Object.keys(s).find(r=>s[r]===!0)||""}catch{return""}}function l(i){i.preventDefault(),i.stopPropagation()}class ${constructor({accordionElement:t,accordionItemSelector:s=".accordion-item",accordionItemToggleSelector:r=".accordion-item-toggle",openClass:o="show",closeClass:a="hide",transitionClass:u="transitioning",transitionDuration:m=250,openDuration:f=-1,closeDuration:p=-1,optionalKeySupport:C=!1,allowMultipleExpand:y=!0,allowNoExpand:g=!0,initialize:w=!1,prefix:E="am-"}){e(this,"_dom",{accordion:null,accordionItems:[],accordionItemToggles:[]});e(this,"_domLock",["accordion"]);e(this,"_selectors",{accordionItems:"",accordionItemToggles:""});e(this,"_elements",{accordionItems:[]});e(this,"_openClass","show");e(this,"_closeClass","hide");e(this,"_transitionClass","transitioning");e(this,"_transitionDuration",250);e(this,"_openDuration",-1);e(this,"_closeDuration",-1);e(this,"_optionalKeySupport",!0);e(this,"_allowMultipleExpand",!0);e(this,"_allowNoExpand",!0);e(this,"_currentChild",0);e(this,"_errors",[]);this._dom.accordion=t,this._selectors.accordionItems=s,this._selectors.accordionItemToggles=r,this._openClass=o||"",this._closeClass=a||"",this._transitionClass=u||"",this._transitionDuration=m,this._openDuration=f,this._closeDuration=p,this._optionalKeySupport=C,this._allowMultipleExpand=y,this._allowNoExpand=g,this._prefix=E||"",w&&this.initialize()}get openClass(){return this._openClass}get closeClass(){return this._closeClass}get transitionClass(){return this._transitionClass}get currentChild(){return this._currentChild}get dom(){return this._dom}get elements(){return this._elements}get selectors(){return this._selectors}get transitionTimer(){return this._transitionTimer}get optionalKeySupport(){return this._optionalKeySupport}get errors(){return this._errors}set openClass(t){d({openClass:t}),this._openClass!==t&&(this._openClass=t)}set closeClass(t){d({closeClass:t}),this._closeClass!==t&&(this._closeClass=t)}set transitionClass(t){d({transitionClass:t}),this._transitionClass!==t&&(this._transitionClass=t)}set transitionTimer(t){n("number",{value:t}),t>=0&&this._transitionTimer!==t&&(this._transitionTimer=t)}set currentChild(t){n("number",{value:t}),this._currentChild!==t&&t>=0&&t<this._accordionItems.length&&(this._currentChild=t)}set accordionItems(t){n("object",{value:t}),t!=null&&t.isArray()&&t.every(s=>s instanceof k)&&(this._accordionItems=t)}initialize(){try{if(!this._validate())throw new Error(`Graupl Accordion: cannot initialize accordion. The following errors have been found:
 - ${this.errors.join(`
 - `)}`);this._setDOMElements(),this._createChildElements(),this._handleFocus(),this._handleClick(),this._handleKeydown(),this._handleKeyup()}catch(t){console.error(t)}}_setDOMElementType(t,s=this.dom.accordion,r=!0,o=!1){if(typeof this.selectors[t]=="string"){if(this._domLock.includes(t))throw new Error(`Graupl ${this.contructor.name}: "${t}" element cannot be set through _setDOMElementType.`);s!==this.dom.accordion&&T(HTMLElement,{base:s});const u=Array.from(s.querySelectorAll(this.selectors[t])).filter(m=>o?m.parentElement===s:!0);r?this._dom[t]=u:this._dom[t]=[...this._dom[t],...u]}else throw new Error(`Graupl ${this.contructor.name}: "${t}" is not a valid element type.`)}_resetDOMElementType(t){if(typeof this.selectors[t]=="string"){if(this._domLock.includes(t))throw new Error(`Graupl ${this.contructor.name}: "${t}" element cannot be reset through _resetDOMElementType.`);Array.isArray(this._dom[t])?this._dom[t]=[]:this._dom[t]=null}else throw new Error(`Graupl ${this.contructor.name}: "${t}" is not a valid element type.`)}_setDOMElements(){this._setDOMElementType("accordionItems"),this._resetDOMElementType("accordionItemToggles"),this.dom.accordionItems.forEach(t=>{this._setDOMElementType("accordionItemToggles",t,!1)})}_createChildElements(){}_validate(){return!0}_handleFocus(){this.elements.accordionItems.forEach((t,s)=>{t.dom.toggle.addEventListener("focus",()=>{this.currentChild=s})})}_handleClick(){this.elements.accordionItems.forEach((t,s)=>{t.dom.toggle.addEventListener("pointerup",()=>{this.currentChild=s,t.toggle()})})}_handleKeydown(){this.dom.accordionItemToggles.forEach(t=>{t.addEventListener("keydown",s=>{const r=_(s);(["Space","Enter"].includes(r)||this.optionalKeySupport&&["ArrowDown","ArrowUp","Home","End"].includes(r))&&l(s)})})}_handleKeyup(){this.dom.accordionItemToggles.forEach(t=>{t.addEventListener("keyup",s=>{switch(_(s)){case"Space":case"Enter":l(s),this.currentAccordionItem.toggle();break;case"Home":l(s),this.focusFirstChild();break;case"End":l(s),this.focusLastChild();break;case"ArrowDown":l(s),this.focusNextChild();break;case"ArrowUp":l(s),this.focusPreviousChild();break}})})}_setTransitionDurations(){this.dom.accordion.style.setProperty(`--${this.prefix}accordion-transition-duration`,`${this.transitionDuration}ms`),this.dom.accordion.style.setProperty(`--${this.prefix}accordion-open-transition-duration`,`${this.openDuration}ms`),this.dom.accordion.style.setProperty(`--${this.prefix}accordion-close-transition-duration`,`${this.closeDuration}ms`)}focusCurrentChild(){this.currentChild!==-1&&this.currentAccordionItem.focus()}focusChild(t){this.blurCurrentChild(),this.currentChild=t,this.focusCurrentChild()}focusFirstChild(){this.focusChild(0)}focusLastChild(){this.focusChild(this.elements.accordionItems.length-1)}focusNextChild(){this.currentChild<this.elements.accordionItems.length-1?this.focusChild(this.currentChild+1):this.focusCurrentChild()}focusPreviousChild(){this.currentChild>0?this.focusChild(this.currentChild-1):this.focusCurrentChild()}blurCurrentChild(){this.currentChild!==-1&&this.currentAccordionItem.blur()}}module.exports=$;
