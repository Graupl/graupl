var Accordion=function(){"use strict";var D=Object.defineProperty;var x=(c,r,l)=>r in c?D(c,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[r]=l;var o=(c,r,l)=>x(c,typeof r!="symbol"?r+"":r,l);function c(i,t){try{if(typeof t!="object"){const e=typeof t;throw new TypeError(`Elements given to isValidInstance() must be inside of an object. "${e}" given.`)}for(const e in t)if(!(t[e]instanceof i)){const s=typeof t[e];throw new TypeError(`${e} must be an instance of ${i.name}. "${s}" given.`)}return{status:!0,error:null}}catch(e){return{status:!1,error:e}}}function r(i,t){try{if(typeof t!="object"){const e=typeof t;throw new TypeError(`Values given to isValidType() must be inside of an object. "${e}" given.`)}for(const e in t){const s=typeof t[e];if(s!==i)throw new TypeError(`${e} must be a ${i}. "${s}" given.`)}return{status:!0,error:null}}catch(e){return{status:!1,error:e}}}function l(i){try{if(typeof i!="object"){const t=typeof i;throw new TypeError(`Values given to isQuerySelector() must be inside of an object. "${t}" given.`)}for(const t in i)try{if(i[t]===null)throw new Error;document.querySelector(i[t])}catch{throw new TypeError(`${t} must be a valid query selector. "${i[t]}" given.`)}return{status:!0,error:null}}catch(t){return{status:!1,error:t}}}function f(i){try{if(typeof i!="object"||Array.isArray(i)){const t=typeof i;throw new TypeError(`Values given to isValidClassList() must be inside of an object. "${t}" given.`)}for(const t in i){const e=typeof i[t];if(e!=="string")if(Array.isArray(i[t]))i[t].forEach(s=>{if(typeof s!="string")throw new TypeError(`${t} must be a string or an array of strings. An array containing non-strings given.`)});else throw new TypeError(`${t} must be a string or an array of strings. "${e}" given.`);else{const s={};s[t]=i[t],l(s)}}return{status:!0,error:null}}catch(t){return{status:!1,error:t}}}function d(i,t){i===""||i.length===0||(typeof i=="string"?t.classList.add(i):t.classList.add(...i))}function m(i,t){i===""||i.length===0||(typeof i=="string"?t.classList.remove(i):t.classList.remove(...i))}class g{constructor({accordionItemElement:t,accordionItemToggleElement:e,accordionItemContentElement:s,parentAccordion:n=null}){o(this,"_dom",{item:null,toggle:null,content:null});o(this,"_elements",{parentAccordion:null});o(this,"_open",!1);o(this,"_showEvent",new CustomEvent("grauplAccordionItemShow",{bubbles:!0,detail:{item:this}}));o(this,"_hideEvent",new CustomEvent("grauplAccordionItemHide",{bubbles:!0,detail:{item:this}}));this._dom.item=t,this._dom.toggle=e,this._dom.content=s,this._elements.parentAccordion=n}initialize(){this._setIds(),this._setAriaAttributes(),this.dom.toggle.getAttribute("aria-expanded")==="true"?this.show(!1):this.hide(!1)}get dom(){return this._dom}get elements(){return this._elements}get isOpen(){return this._open}set isOpen(t){r("boolean",{value:t}),this._open!==t&&(this._open=t)}_setIds(){}_setAriaAttributes(){}show(t=!0){if(this._open)return;const{closeClass:e,openClass:s,transitionClass:n,openDuration:a}=this.elements.parentAccordion;this.dom.toggle.setAttribute("aria-expanded","true"),n!==""?(d(n,this.dom.item),requestAnimationFrame(()=>{m(e,this.dom.item),this.dom.content.style.height="0px",requestAnimationFrame(()=>{d(s,this.dom.item),this.dom.content.style.height=`${this.dom.content.scrollHeight}px`,requestAnimationFrame(()=>{setTimeout(()=>{m(n,this.dom.item),this.dom.content.style.height=""},a)})})})):(d(s,this.dom.item),m(e,this.dom.item)),this._open=!0,t&&this.dom.item.dispatchEvent(this._showEvent)}hide(t=!0){if(!this._open)return;const{closeClass:e,openClass:s,transitionClass:n,closeDuration:a}=this.elements.parentAccordion;this.dom.toggle.setAttribute("aria-expanded","false"),n!==""?(d(n,this.dom.item),this.dom.content.style.height=`${this.dom.content.getBoundingClientRect().height}px`,requestAnimationFrame(()=>{m(s,this.dom.item),this.dom.content.style.height="0px",requestAnimationFrame(()=>{d(e,this.dom.item),requestAnimationFrame(()=>{setTimeout(()=>{m(n,this.dom.item),this.dom.content.style.height=""})},a)})})):(d(e,this.dom.item),m(s,this.dom.item)),this._open=!1,t&&this.dom.item.dispatchEvent(this._hideEvent)}toggle(){this.isOpen?this.hide():this.show()}focus(){this.dom.toggle.focus()}blur(){this.dom.toggle.blur()}}function _(i){try{const t=i.key||i.keyCode,e={Enter:t==="Enter"||t===13,Space:t===" "||t==="Spacebar"||t===32,Escape:t==="Escape"||t==="Esc"||t===27,ArrowUp:t==="ArrowUp"||t==="Up"||t===38,ArrowRight:t==="ArrowRight"||t==="Right"||t===39,ArrowDown:t==="ArrowDown"||t==="Down"||t===40,ArrowLeft:t==="ArrowLeft"||t==="Left"||t===37,Home:t==="Home"||t===36,End:t==="End"||t===35,Tab:t==="Tab"||t===9};return Object.keys(e).find(s=>e[s]===!0)||""}catch{return""}}function h(i){i.preventDefault(),i.stopPropagation()}class y{constructor({accordionElement:t,accordionItemSelector:e=".accordion-item",accordionItemToggleSelector:s=".accordion-item-toggle",accordionItemContentSelector:n=".accordion-item-content",openClass:a="show",closeClass:u="hide",transitionClass:p="transitioning",transitionDuration:C=250,openDuration:E=-1,closeDuration:w=-1,optionalKeySupport:A=!1,allowMultipleExpand:b=!0,allowNoExpand:I=!0,key:k=null,initialize:T=!1,prefix:$="am-"}){o(this,"_dom",{accordion:null,accordionItems:[],accordionItemToggles:[],accordionItemContents:[]});o(this,"_domLock",["accordion"]);o(this,"_selectors",{accordionItems:"",accordionItemToggles:"",accordionItemContents:""});o(this,"_elements",{accordionItems:[]});o(this,"_openClass","show");o(this,"_closeClass","hide");o(this,"_transitionClass","transitioning");o(this,"_transitionDuration",250);o(this,"_openDuration",-1);o(this,"_closeDuration",-1);o(this,"_optionalKeySupport",!0);o(this,"_allowMultipleExpand",!0);o(this,"_allowNoExpand",!0);o(this,"_currentChild",0);o(this,"_prefix","graupl-");o(this,"_key","");o(this,"_errors",[]);this._dom.accordion=t,this._selectors.accordionItems=e,this._selectors.accordionItemToggles=s,this._selectors.accordionItemContents=n,this._openClass=a||"",this._closeClass=u||"",this._transitionClass=p||"",this._transitionDuration=C,this._openDuration=E,this._closeDuration=w,this._optionalKeySupport=A,this._allowMultipleExpand=b,this._allowNoExpand=I,this._prefix=$||"",this._key=k||"",T&&this.initialize()}get openClass(){return this._openClass}get closeClass(){return this._closeClass}get transitionClass(){return this._transitionClass}get currentChild(){return this._currentChild}get dom(){return this._dom}get elements(){return this._elements}get selectors(){return this._selectors}get transitionTimer(){return this._transitionTimer}get optionalKeySupport(){return this._optionalKeySupport}get currentAccordionItem(){return this.elements.accordionItems[this.currentChild]}get prefix(){return this._prefix}get key(){return this._key}get errors(){return this._errors}set openClass(t){f({openClass:t}),this._openClass!==t&&(this._openClass=t)}set closeClass(t){f({closeClass:t}),this._closeClass!==t&&(this._closeClass=t)}set transitionClass(t){f({transitionClass:t}),this._transitionClass!==t&&(this._transitionClass=t)}set transitionTimer(t){r("number",{value:t}),t>=0&&this._transitionTimer!==t&&(this._transitionTimer=t)}set currentChild(t){r("number",{value:t}),this._currentChild!==t&&t>=0&&t<this.elements.accordionItems.length&&(this._currentChild=t)}set accordionItems(t){r("object",{value:t}),t!=null&&t.isArray()&&t.every(e=>e instanceof g)&&(this._accordionItems=t)}set prefix(t){r("string",{value:t}),this._prefix!==t&&(this._prefix=t)}set key(t){r("string",{value:t}),this._key!==t&&(this._key=t)}initialize(){try{if(!this._validate())throw new Error(`Graupl Accordion: cannot initialize accordion. The following errors have been found:
 - ${this.errors.join(`
 - `)}`);this._generateKey(),this._setDOMElements(),this._createChildElements(),this._handleFocus(),this._handleClick(),this._handleKeydown(),this._handleKeyup()}catch(t){console.error(t)}}_setDOMElementType(t,e=this.dom.accordion,s=!0,n=!1){if(typeof this.selectors[t]=="string"){if(this._domLock.includes(t))throw new Error(`Graupl ${this.contructor.name}: "${t}" element cannot be set through _setDOMElementType.`);e!==this.dom.accordion&&c(HTMLElement,{base:e});const u=Array.from(e.querySelectorAll(this.selectors[t])).filter(p=>n?p.parentElement===e:!0);s?this._dom[t]=u:this._dom[t]=[...this._dom[t],...u]}else throw new Error(`Graupl ${this.contructor.name}: "${t}" is not a valid element type.`)}_resetDOMElementType(t){if(typeof this.selectors[t]=="string"){if(this._domLock.includes(t))throw new Error(`Graupl ${this.contructor.name}: "${t}" element cannot be reset through _resetDOMElementType.`);Array.isArray(this._dom[t])?this._dom[t]=[]:this._dom[t]=null}else throw new Error(`Graupl ${this.contructor.name}: "${t}" is not a valid element type.`)}_setDOMElements(){this._setDOMElementType("accordionItems"),this._resetDOMElementType("accordionItemToggles"),this.dom.accordionItems.forEach(t=>{this._setDOMElementType("accordionItemToggles",t,!1),this._setDOMElementType("accordionItemContents",t,!1)})}_generateKey(t=!1){(this.key===""||t)&&(this.key=Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,10))}_createChildElements(){this.dom.accordionItems.forEach((t,e)=>{const s=new g({accordionItemElement:t,accordionItemToggleElement:this.dom.accordionItemToggles[e],accordionItemContentElement:this.dom.accordionItemContents[e],parentAccordion:this});s.initialize(),this.elements.accordionItems.push(s)})}_validate(){return!0}_handleFocus(){this.elements.accordionItems.forEach((t,e)=>{t.dom.toggle.addEventListener("focus",()=>{this.currentChild=e})})}_handleClick(){this.elements.accordionItems.forEach((t,e)=>{t.dom.toggle.addEventListener("pointerup",()=>{this.currentChild=e,t.toggle()})})}_handleKeydown(){this.dom.accordionItemToggles.forEach(t=>{t.addEventListener("keydown",e=>{const s=_(e);(["Space","Enter"].includes(s)||this.optionalKeySupport&&["ArrowDown","ArrowUp","Home","End"].includes(s))&&h(e)})})}_handleKeyup(){this.dom.accordionItemToggles.forEach(t=>{t.addEventListener("keyup",e=>{switch(_(e)){case"Space":case"Enter":h(e),this.currentAccordionItem.toggle();break;case"Home":h(e),this.focusFirstChild();break;case"End":h(e),this.focusLastChild();break;case"ArrowDown":h(e),this.focusNextChild();break;case"ArrowUp":h(e),this.focusPreviousChild();break}})})}_setTransitionDurations(){this.dom.accordion.style.setProperty(`--${this.prefix}accordion-transition-duration`,`${this.transitionDuration}ms`),this.dom.accordion.style.setProperty(`--${this.prefix}accordion-open-transition-duration`,`${this.openDuration}ms`),this.dom.accordion.style.setProperty(`--${this.prefix}accordion-close-transition-duration`,`${this.closeDuration}ms`)}focusCurrentChild(){this.currentChild!==-1&&this.currentAccordionItem.focus()}focusChild(t){this.blurCurrentChild(),this.currentChild=t,this.focusCurrentChild()}focusFirstChild(){this.focusChild(0)}focusLastChild(){this.focusChild(this.elements.accordionItems.length-1)}focusNextChild(){this.currentChild<this.elements.accordionItems.length-1?this.focusChild(this.currentChild+1):this.focusCurrentChild()}focusPreviousChild(){this.currentChild>0?this.focusChild(this.currentChild-1):this.focusCurrentChild()}blurCurrentChild(){this.currentChild!==-1&&this.currentAccordionItem.blur()}}return y}();
